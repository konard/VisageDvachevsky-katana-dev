# KATANA Profiling Directory

This directory contains profiling artifacts and flamegraphs generated by the deep profiling pipeline.

## Directory Structure

```
profiling/
├── README.md               # This file
└── flamegraphs/            # Generated flamegraph SVG files
    ├── user_flamegraph.svg    # User-space call stacks
    ├── kernel_flamegraph.svg  # Kernel-space call stacks
    └── mixed_flamegraph.svg   # Combined user+kernel stacks
```

## Generating Flamegraphs

Use the deep profiling script:

```bash
# Basic flamegraph generation
./scripts/profile_deep.sh --target simple_benchmark --flamegraph

# Full profiling with specific duration
./scripts/profile_deep.sh --target performance_benchmark --flamegraph --duration 60 --mode cache

# Available targets
# - simple_benchmark
# - performance_benchmark
# - router_benchmark
# - io_buffer_benchmark
# - timer_benchmark
```

## Viewing Flamegraphs

Flamegraphs are interactive SVG files. Open them in any web browser:

```bash
# Linux
firefox docs/profiling/flamegraphs/mixed_flamegraph.svg

# macOS
open docs/profiling/flamegraphs/mixed_flamegraph.svg
```

### Flamegraph Navigation

- **Click** on a stack frame to zoom in
- **Ctrl+Click** or **Reset** to zoom out
- **Search** (Ctrl+F) to highlight matching functions
- **Hover** to see function name and percentage

## Raw Profiling Data

Detailed profiling results are stored in `profiling_results/` at the project root:

```
profiling_results/
└── <target>_<timestamp>/
    ├── perf.data           # Raw perf data
    ├── perf.folded         # Folded stacks for flamegraph
    ├── perf_stat.txt       # Hardware counter output
    ├── perf_report.txt     # perf report output
    ├── analysis.md         # Automated analysis
    └── flamegraphs/        # SVG flamegraphs
```

## FlameGraph Installation

If flamegraphs are not being generated, install FlameGraph:

```bash
git clone https://github.com/brendangregg/FlameGraph.git ~/FlameGraph
```

The profiling script will automatically detect it in `~/FlameGraph` or `/opt/FlameGraph`.
